

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Task Developer’s Guide &mdash; pants 0.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/pants-logo.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'0.1',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="pants 0.1 documentation" href="index.html"/>
        <link rel="up" title="Pants Developer Center" href="dev.html"/>
        <link rel="next" title="Pants Development with IntelliJ IDEA" href="intellij.html"/>
        <link rel="prev" title="Pants Developers Guide" href="howto_develop.html"/>
 
<script type="text/javascript">
  // In a plain template, we'd put this in the footer block.
  // In the read-the-docs template, there is no footer. So use jQuery ready:
  $(document).ready(function() {
    // Ping Google analytics
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-39101739-2', 'auto');
    ga('send', 'pageview');

    // Show the travis-ci status graphic
    $('.wy-breadcrumbs').append(
      '<div style="float: right;">' +
      '<a href="https://travis-ci.org/pantsbuild/pants">' +
      '<img src="https://travis-ci.org/pantsbuild/pants.png?branch=master">' +
      '</a></div>');
  });
</script>
<style type="text/css">
/* Shoehorn in pants logo */
body .icon-home:before {
   content: "";
}

body .icon-home{
  background: transparent url(./_static/pants-logo.ico) center left no-repeat;
  background-position-x: 5px;
  padding-left: 40px;
  padding-right: 35px;
  line-height: 40px;
}

body a.icon-home:hover{
  background: #3d8cbf url(./_static/pants-logo.ico) center left no-repeat;
  background-position-x: 5px;
}

</style>


  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="icon icon-home"> pants</a>
        <form class="wy-form" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="first_concepts.html">Pants Conceptual Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="first_concepts.html#goals-and-targets">Goals and Targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="first_concepts.html#target-types">Target Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="first_concepts.html#what-pants-does">What Pants Does</a></li>
<li class="toctree-l2"><a class="reference internal" href="first_concepts.html#next-step">Next Step</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="first_tutorial.html">First Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="first_tutorial.html#invoking-pants">Invoking Pants</a></li>
<li class="toctree-l2"><a class="reference internal" href="first_tutorial.html#build-files">BUILD Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="first_tutorial.html#the-usual-commands">The Usual Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="first_tutorial.html#next">Next</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="target_addresses.html">Target Addresses</a></li>
<li class="toctree-l1"><a class="reference internal" href="JVMProjects.html">JVM Projects with Pants</a><ul>
<li class="toctree-l2"><a class="reference internal" href="JVMProjects.html#relevant-goals-and-targets">Relevant Goals and Targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="JVMProjects.html#build-for-a-simple-binary">BUILD for a Simple Binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="JVMProjects.html#the-usual-commands-jvm">The Usual Commands: JVM</a></li>
<li class="toctree-l2"><a class="reference internal" href="JVMProjects.html#toolchain">Toolchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="JVMProjects.html#java7-vs-java6-which-java">Java7 vs Java6, Which Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="JVMProjects.html#bundles-deploy-able-runnable-file-trees">Bundles: Deploy-able Runnable File Trees</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python-readme.html">Python Projects with Pants</a><ul>
<li class="toctree-l2"><a class="reference internal" href="python-readme.html#relevant-goals-and-targets">Relevant Goals and Targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-readme.html#build-for-a-simple-binary">BUILD for a Simple Binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-readme.html#handling-python-requirement">Handling <tt class="docutils literal"><span class="pre">python_requirement</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="python-readme.html#pex-contents">PEX Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-readme.html#repl-and-environment-manipulation-with-pants-py">REPL and environment manipulation with <cite>pants py</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="python-readme.html#python-binary-entry-point">python_binary entry_point</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-readme.html#more-about-python-tests">More About Python Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-readme.html#manipulating-pex-behavior-with-environment-variables">Manipulating PEX behavior with environment variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page.html">README Files and Markdown</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page.html#markdown-to-html">Markdown to HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html#link-to-another-page">Link to Another <tt class="docutils literal"><span class="pre">page</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html#publishing">Publishing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="build_files.html">BUILD files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="build_files.html#debugging-a-build-file">Debugging a BUILD File</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_files.html#default-target">Default Target</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_files.html#the-1-1-1-rule">The 1:1:1 Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_files.html#avoid-rglobs">Avoid rglobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_files.html#define-separate-targets-for-interface-and-implementation">Define Separate Targets for Interface and Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_files.html#depend-on-api-in-library-targets-implementation-in-binary-targets">Depend on API in Library Targets, Implementation in Binary Targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_files.html#which-build-files-are-executed-and-how">Which <tt class="docutils literal"><span class="pre">BUILD</span></tt> Files are &#8220;Executed&#8221;? (and how?)</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_files.html#id1">BUILD.* files</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_files.html#tag-incompatibilities-with-exclusives">Tag Incompatibilities with exclusives</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="invoking.html">Invoking Pants Build</a><ul>
<li class="toctree-l2"><a class="reference internal" href="invoking.html#rc-files">rc files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tshoot.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tshoot.html#maximum-verbosity">Maximum Verbosity</a></li>
<li class="toctree-l2"><a class="reference internal" href="tshoot.html#scrub-the-environment">Scrub the Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="tshoot.html#nailgun-5-seconds">Nailgun 5 seconds</a></li>
<li class="toctree-l2"><a class="reference internal" href="tshoot.html#questions-issues-bug-reports">Questions, Issues, Bug Reports</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="3rdparty.html">Third-Party Dependencies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="3rdparty_jvm.html">JVM 3rdparty Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="3rdparty_py.html">Python 3rdparty Pattern</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ThriftDeps.html">Using Pants with Thrift Dependencies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ThriftDeps.html#generating-code">Generating Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="ThriftDeps.html#thrift-example">Thrift Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="ThriftDeps.html#publishing">Publishing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="publish.html">Publishing Artifacts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="publish.html#life-of-a-publish">Life of a Publish</a></li>
<li class="toctree-l2"><a class="reference internal" href="publish.html#how-to">How To</a></li>
<li class="toctree-l2"><a class="reference internal" href="publish.html#restricting-to-release-branch">Restricting to &#8220;Release Branch&#8221;</a></li>
<li class="toctree-l2"><a class="reference internal" href="publish.html#authenticating-to-the-artifact-repository">Authenticating to the Artifact Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="publish.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="publish.html#want-to-publish-something-publish-many-things">Want to Publish Something? Publish Many Things</a></li>
<li class="toctree-l2"><a class="reference internal" href="publish.html#test-with-a-fake-local-publish">Test with a Fake Local &#8220;Publish&#8221;</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="with_emacs.html">Ensime With Pants</a></li>
<li class="toctree-l1"><a class="reference internal" href="with_intellij.html">Using Pants with IntelliJ IDEA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="with_intellij.html#pants-build-plugin-for-intellij">Pants Build Plugin for IntelliJ</a></li>
<li class="toctree-l2"><a class="reference internal" href="with_intellij.html#generating-idea-project">Generating IDEA Project</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="setup_repo.html">Set up Your Source Tree for Pants</a><ul>
<li class="toctree-l2"><a class="reference internal" href="setup_repo.html#configuring-with-pants-ini">Configuring with <tt class="docutils literal"><span class="pre">pants.ini</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="setup_repo.html#configure-code-layout-with-source-root">Configure Code Layout with <cite>source_root</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="setup_repo.html#top-level-build-for-tree-global-config">Top-level <cite>BUILD.*</cite> for tree-global config</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup_repo.html#build-in-the-source-tree-for-special-targets">BUILD.* in the source tree for special targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup_repo.html#restricting-publish-to-release-branch">Restricting Publish to &#8220;Release Branch&#8221;</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing Pants</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#pex-based-installation">PEX-based Installation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_dictionary.html">BUILD Dictionary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#android-binary">android_binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#android-resources">android_resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#annotation-processor">annotation_processor</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#artifact">artifact</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#benchmark">benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#buildfile-path">buildfile_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#bundle">bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#config">config</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#confluencepublish">ConfluencePublish</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#credentials">credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#dependencies">dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#duplicate">Duplicate</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#egg">egg</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#exclude">exclude</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#get-buildroot">get_buildroot</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#get-scm">get_scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#globs">globs</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#goal">goal</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#jar">jar</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#jar-library">jar_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#jar-rules">jar_rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#java-agent">java_agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#java-antlr-library">java_antlr_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#java-library">java_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#java-protobuf-library">java_protobuf_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#java-ragel-library">java_ragel_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#java-tests">java_tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#java-thrift-library">java_thrift_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#jaxb-library">jaxb_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#junit-tests">junit_tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#jvm-app">jvm_app</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#jvm-binary">jvm_binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#maven-layout">maven_layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#netrc">netrc</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#page">page</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#pants">pants</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#pants-version">pants_version</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#phase">phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#python-antlr-library">python_antlr_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#python-binary">python_binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#python-library">python_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#python-requirement">python_requirement</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#python-requirement-library">python_requirement_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#python-requirements">python_requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#python-test-suite">python_test_suite</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#python-tests">python_tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#python-thrift-library">python_thrift_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#repo">repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#resources">resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#rglobs">rglobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#scala-library">scala_library</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#scala-specs">scala_specs</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#scala-tests">scala_tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#scalac-plugin">scalac_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#set-scm">set_scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#setup-py">setup_py</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#skip">Skip</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#source-root">source_root</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#wiki">wiki</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#wiki-artifact">wiki_artifact</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dictionary.html#zglobs">zglobs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="goals_reference.html">Goals Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#bench">bench</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#binary">binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#bootstrap">bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#builddict">builddict</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#buildlint">buildlint</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#bundle">bundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#changed">changed</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#check-exclusives">check-exclusives</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#check-published-deps">check_published_deps</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#clean-all">clean-all</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#clean-all-async">clean-all-async</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#compile">compile</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#dependees">dependees</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#dependencies">dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#depmap">depmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#detect-duplicates">detect-duplicates</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#dex">dex</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#doc">doc</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#eclipse">eclipse</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#ensime">ensime</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#filedeps">filedeps</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#filemap">filemap</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#filter">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#gen">gen</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#goals">goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#gref-phase-idea">idea</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#imports">imports</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#invalidate">invalidate</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#jar">jar</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#killserver">killserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#list">list</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#markdown">markdown</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#minimize">minimize</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#ng-killall">ng-killall</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#path">path</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#pathdeps">pathdeps</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#paths">paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#provides">provides</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#publish">publish</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#repl">repl</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#repl-dirty">repl-dirty</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#resolve">resolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#resources">resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#roots">roots</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#run">run</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#run-dirty">run-dirty</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#server">server</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#sort">sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#targets">targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#test">test</a></li>
<li class="toctree-l2"><a class="reference internal" href="goals_reference.html#common">Common</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="dev.html">Pants Developer Center</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="howto_contribute.html">Pants Contributors Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto_ask.html">How To Ask</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto_develop.html">Pants Developers Guide</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Task Developer&#8217;s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="intellij.html">Pants Development with IntelliJ IDEA</a></li>
<li class="toctree-l2"><a class="reference internal" href="internals.html">Pants Internals</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs.html">About the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">pants</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
  <li><a href="index.html">Docs</a> &raquo;</li>
  <li><a href="">Task Developer&#8217;s Guide</a></li>
  
</ul>
<hr/>

          
  <div class="section" id="task-developer-s-guide">
<h1>Task Developer&#8217;s Guide<a class="headerlink" href="#task-developer-s-guide" title="Permalink to this headline">¶</a></h1>
<p>This page documents how to develop pants tasks, enabling you to teach pants
how to do things it does not already know how to do today. This page makes
more sense if you know the concepts from <a class="reference internal" href="internals.html"><em>Pants Internals</em></a>.</p>
<div class="section" id="pagerank-example">
<h2>PageRank Example<a class="headerlink" href="#pagerank-example" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s dive in an look at a fully-functional task.
Generating reports its a common user request, as folks often want to learn
more about their builds. Target dependencies and dependees are a couple
examples. Let&#8217;s explore how to generate a new report, such as running PageRank
over the targets graph. Perhaps you&#8217;re just curious to see what the most
popular targets are, or maybe you want to use that information to focus
testing efforts.</p>
<p>Let&#8217;s remind ourselves of the simplified
<a class="reference external" href="http://www.cs.princeton.edu/~chazelle/courses/BIB/pagerank.htm">PageRank algorithm</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">PR</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="p">(</span><span class="n">PR</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span><span class="o">/</span><span class="n">C</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span> <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">PR</span><span class="p">(</span><span class="n">Tn</span><span class="p">)</span><span class="o">/</span><span class="n">C</span><span class="p">(</span><span class="n">Tn</span><span class="p">))</span>
</pre></div>
</div>
<p>Where <tt class="docutils literal"><span class="pre">T</span></tt> are our targets, and dependencies are analogous to inbound links.
To perform such a calculation we simply need to walk the targets graph to
identify all target dependees, then perform the above calculation some number
of iterations, and finally display the results.</p>
<p>Now let&#8217;s look at PageRank. First, notice we subclass <tt class="docutils literal"><span class="pre">ConsoleTask</span></tt> which
provides conveniences when generating reports. Also, notice we don&#8217;t define
an explicit constructor as there&#8217;s no configuration to setup nor do we need
to register product requirements. We implement <tt class="docutils literal"><span class="pre">console_output</span></tt> as
required by <tt class="docutils literal"><span class="pre">ConsoleTask</span></tt> which parses the targets graph, calculates
pagerank, then returns the report lines.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># coding=utf-8</span>
<span class="c"># Copyright 2014 Pants project contributors (see CONTRIBUTORS.md).</span>
<span class="c"># Licensed under the Apache License, Version 2.0 (see LICENSE).</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="p">(</span><span class="n">nested_scopes</span><span class="p">,</span> <span class="n">generators</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">with_statement</span><span class="p">,</span>
                        <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="kn">from</span> <span class="nn">pants</span> <span class="kn">import</span> <span class="n">is_concrete</span>  <span class="c"># XXX This target doesn&#39;t exist</span>
<span class="kn">from</span> <span class="nn">pants.backend.core.tasks.console_task</span> <span class="kn">import</span> <span class="n">ConsoleTask</span>


<span class="k">class</span> <span class="nc">PageRank</span><span class="p">(</span><span class="n">ConsoleTask</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Measure how &quot;depended-upon&quot; the targets are.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">console_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
    <span class="n">dependencies_by_target</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
    <span class="n">dependees_by_target</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
</pre></div>
</div>
<p>When processing dependencies we populate the maps by walking a filtered
targets graph. It&#8217;s quite common for tasks to only know how to handle
specific target types.</p>
<div class="highlight-python"><div class="highlight"><pre>    self._calc_deps(targets, dependencies_by_target, dependees_by_target)
    self._pagerank(dependees_by_target, dependencies_by_target, pagerank_by_target)
    return self._report(pagerank_by_target)

  def _calc_deps(self, targets, dependencies_by_target, dependees_by_target):
    for target in filter(lambda x: hasattr(x, &quot;dependencies&quot;), targets):
      if not dependencies_by_target.has_key(target):
        for dependency in target.dependencies:
          for resolved in dependency.resolve():
            if is_concrete(resolved):
              dependencies_by_target[target].add(resolved)
</pre></div>
</div>
<p>Now let&#8217;s calculate pagerank.</p>
<div class="highlight-python"><div class="highlight"><pre>      for dependency in target.dependencies:
        for resolved in dependency.resolve():
          if is_concrete(resolved):
            dependees_by_target[resolved].add(target)

  def _pagerank(self, dependees_by_target, dependencies_by_target, pagerank_by_target):
    &quot;&quot;&quot;Calculate PageRank.&quot;&quot;&quot;
    d = 0.85
</pre></div>
</div>
<p>And finally return the report lines.</p>
<div class="highlight-python"><div class="highlight"><pre>      <span class="k">for</span> <span class="n">target</span><span class="p">,</span> <span class="n">dependees</span> <span class="ow">in</span> <span class="n">dependees_by_target</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="n">contributions</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
          <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">pagerank_by_target</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">dependencies_by_target</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">dependees</span><span class="p">)</span>
        <span class="n">pagerank_by_target</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s see the report in action! Here we&#8217;ll look at the most popular
target dependencies. As expected, foundational jars and targets
are identified. Let&#8217;s say we wanted to restrict this report to
internal or external-only targets. Well... that&#8217;s your homework :)</p>
<div class="highlight-python"><div class="highlight"><pre>$ ./pants goal pagerank src/java/com/twitter/common/:: | head
8.283371 - com.google.code.findbugs-jsr305-1.3.9
7.433371 - javax.inject-javax.inject-1
7.433371 - com.google.guava-guava-14.0.1
3.107220 - commons-lang-commons-lang-2.5
2.537617 - com.google.inject-guice-3.0
2.519704 - JavaLibrary(src/java/com/twitter/common/base/BUILD:base)
2.205346 - javax.servlet-servlet-api-2.5
2.042915 - org.hamcrest-hamcrest-core-1.2
1.898855 - org.slf4j-slf4j-jdk14-1.6.1
1.898855 - org.slf4j-slf4j-api-1.6.1
</pre></div>
</div>
<p>As you can see, generating reports is quite simple. We have the opportunity
to configure the task, and implement a simple interface that processes the
targets graph and generates a report on what it finds out.</p>
</div>
<div class="section" id="core-concepts">
<h2>Core Concepts<a class="headerlink" href="#core-concepts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="task-base-class">
<h3>Task Base Class<a class="headerlink" href="#task-base-class" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s examine the Task class, which is the &#8220;abstract class&#8221;
we&#8217;ll need to subclass. The following simplified example highlights
the most useful methods.</p>
<ul class="simple">
<li><tt class="xref py py-class docutils literal"><span class="pre">pants.tasks.__init__.Task</span></tt> - This is the base class
used to implement all the stuff pants knows how to do. When instantiating
a task it has the opportunity to perform setup actions, or fetch
configuration info from the context or <tt class="docutils literal"><span class="pre">pants.ini</span></tt>. If it needs
products produced by some other task it must register interest in
those products (e.g.: &#8220;I&#8217;m a java compiler, I need java sources.&#8221;).</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">pants.tasks.__init__.Task.execute()</span></tt> - Do some work.
This is where the task does its thing. In addition to anything stashed
away during instantiation, it has access to the targets graph.</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">pants.tasks.__init__.Task.setup_parser()</span></tt> - Specify
command-line flags. These are useful for functionality that may be
modified per-invocation. Use <tt class="docutils literal"><span class="pre">pants.ini</span></tt> for configuration that
should always be used in the repo.</li>
</ul>
</div>
<div class="section" id="targets-graph-traversal">
<h3>Targets Graph Traversal<a class="headerlink" href="#targets-graph-traversal" title="Permalink to this headline">¶</a></h3>
<p>Many tasks involve traversing the targets graph looking for targets of
particular types, and taking actions on those targets. For this reason
its important to understand now to navigate the targets graph.</p>
<p>The targets graph is provided to your
<tt class="xref py py-meth docutils literal"><span class="pre">pants.tasks.__init__.Task.execute()</span></tt> method, and you have
exclusive access to read and/or mutate it in place during execution.
Its provided as the list of <em>active concrete targets</em>. <em>Active</em> meaning
these targets are reachable by one or more <tt class="docutils literal"><span class="pre">target_roots</span></tt> specified on
the command-line; <em>concrete</em> meaning all targets resolve to themselves,
with any intermediate bags of <tt class="docutils literal"><span class="pre">dependencies</span></tt> removed.</p>
<p>Let&#8217;s explore how to collect all targets of a particular type.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
  <span class="n">interesting_targets</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
    <span class="n">target</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">interesting_targets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
                <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">FooLibrary</span><span class="p">))</span>
</pre></div>
</div>
<p>First we need to iterate over <tt class="docutils literal"><span class="pre">targets</span></tt>, which are the active concrete targets.
Then we <tt class="docutils literal"><span class="pre">walk</span></tt> each concrete target, providing as the first parameter
a callable that each walked target will be passed to. We also provide a callable
as the optional second parameter which filters the targets.</p>
<p>Traversing the targets graph is key to task development, as most tasks perform
some operation on the targets &#8220;in play.&#8221; We iterate over the active concrete
targets, <tt class="docutils literal"><span class="pre">walk</span></tt>ing each one with our visiting callable. By walking the
targets graph you can identify exactly which targets are necessary to implement
your task.</p>
</div>
<div class="section" id="task-installation">
<h3>Task Installation<a class="headerlink" href="#task-installation" title="Permalink to this headline">¶</a></h3>
<p>Tasks must be installed before they are available for use.
Fortunately this is a simple process. They are installed
in <tt class="docutils literal"><span class="pre">register.py</span></tt> as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pants.backend.core.tasks.pagerank</span> <span class="kn">import</span> <span class="n">PageRank</span>
<span class="n">goal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;pagerank&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">PageRank</span><span class="p">)</span><span class="o">.</span><span class="n">install</span><span class="p">()</span><span class="o">.</span><span class="n">with_description</span><span class="p">(</span><span class="s">&#39;PageRank the given targets.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="task-configuration">
<h3>Task Configuration<a class="headerlink" href="#task-configuration" title="Permalink to this headline">¶</a></h3>
<p>Tasks may be configured in two ways, through a configuration file checked
into the repo, and via command-line flags.</p>
<p>The configuration file is always called <tt class="docutils literal"><span class="pre">pants.ini</span></tt> and is a standard
<tt class="docutils literal"><span class="pre">ini</span></tt> file loaded with <tt class="docutils literal"><span class="pre">ConfigParser</span></tt>. During instantiation, tasks have
access to a <tt class="xref py py-class docutils literal"><span class="pre">pants.base.config.Config</span></tt>
to read these settings.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Let&#39;s read mykey from the mytask pants.ini section.</span>
<span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;mytask&#39;</span><span class="p">,</span> <span class="s">&#39;mykey&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Command-line flag values are also available during task instantiation.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Access a command-line flag the task defined.</span>
<span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">myflag</span>
</pre></div>
</div>
</div>
<div class="section" id="jvm-tool-bootstrapping">
<h3>JVM Tool Bootstrapping<a class="headerlink" href="#jvm-tool-bootstrapping" title="Permalink to this headline">¶</a></h3>
<p>If you want to integrate an existing JVM-based tool with a pants task, you need
to be able to bootstrap it, i.e., fetch it and create a classpath with which to run it.</p>
<p>Your job as a task
developer is to set up the arguments passed to your tool (e.g.: source file names
to compile) and do something useful after the tool has run. For example, a code
generation tool would identify targets that own IDL sources, pass those sources
as arguments to the code generator, create targets of the correct type to own
generated sources, and mutate the targets graph rewriting dependencies on targets
owning IDL sources to point at targets that own the generated code.</p>
<p>Tools are specified by targets in a special BUILD.tools file in the root of
your workspace. To bootstrap it you register that target under some key
in the task&#8217;s __init__ method. Then, a special bootstrapping task will use Ivy
to resolve those targets. Then, in your execute() method you can get the
classpath for the tool using its registration key.</p>
<p><a class="reference external" href="http://www.scalastyle.org/">Scalastyle</a> is a tool that enforces style policies
for scala code. Let&#8217;s examine a simplified task that uses this tool. This example has been
condensed from the Scalastyle task provided by pants; please see its sources for a real-world
example, including exemplary configuration and error handling (which your task will have too,
right :)</p>
<div class="highlight-python"><div class="highlight"><pre>class Scalastyle(NailgunTask):
  def __init__(self, *args, **kwargs):
    super(Scalastyle, self).__init__(*args, **kwargs)
    self._scalastyle_config = self.context.config.get_required(&#39;scalastyle, &#39;config&#39;)
    self._scalastyle_bootstrap_key = &#39;scalastyle&#39;
    self.register_jvm_tool(self._scalastyle_bootstrap_key, [&#39;:scalastyle&#39;])

  def execute(self, targets):
    srcs = get_scala_sources(targets)
    cp = self._jvm_tool_bootstrapper.get_jvm_tool_classpath(self._scalastyle_bootstrap_key)
    result = self.runjava(main=&#39;org.scalastyle.Main&#39;,
                          classpath=cp,
                          args=[&#39;-c&#39;, self._scalastyle_config] + srcs)
    if result != 0:
      raise TaskError(&#39;java %s ... exited non-zero (%i)&#39; % (&#39;org.scalastyle.Main&#39;, result))
</pre></div>
</div>
<p>Notice how we subclass <tt class="docutils literal"><span class="pre">NailgunTask</span></tt>. This takes advantage of
<a class="reference external" href="http://www.martiansoftware.com/nailgun/">Nailgun</a> to speed up any tool with
a fixed classpath.
Our constructor is straightforward, simply identifying the configuration file and
registering the tool.
Our <tt class="docutils literal"><span class="pre">execute</span></tt> magically finds all the scala sources to check (we&#8217;re focusing on
bootstrapping here), and fetches the classpath to use. Pay attention to the <tt class="docutils literal"><span class="pre">runjava</span></tt> line -
that&#8217;s where the tool classpath is used. We simply say what main to execute, with what
classpath, and what program args to use. As Scalastyle is a barrier in our build, we fail
the build if files do not conform to the configured policy.</p>
<p>Note that the above description was a slight simplification. The bootstrapping task doesn&#8217;t
actually invoke Ivy. Instead it creates a callback that invokes Ivy in just the right
way. This callback is called lazily on demand, the first time you call get_jvm_tool_classpath()
with a given key. This lazy invocation improves performance - we only invoke Ivy when we know
we really do need to use the tool.</p>
</div>
</div>
</div>


          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="intellij.html" class="btn btn-neutral float-right" title="Pants Development with IntelliJ IDEA"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="howto_develop.html" class="btn btn-neutral" title="Pants Developers Guide"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
      &copy; Copyright 2014, Pants project contributors.
  </p>

  <a href="https://www.github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="http://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

</body>
</html>